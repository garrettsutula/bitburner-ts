import { NS } from '@ns'
import { calculateWeaken, calculateGrow, calculateHack, calculateStepsDuration, calculateStepsRamNeeded } from 'scheduler/stages/calculate'
import { Procedure } from '/models/procedure';
const scriptPaths = {
  hack: '/spider/hack.js',
  grow: '/spider/grow.js',
  weaken: '/spider/weaken.js',
};

export function exploitSchedule(ns: NS, host: string): Procedure {
  const hack = calculateHack(ns, host, scriptPaths.hack);
  const firstWeaken = calculateWeaken(ns, host, scriptPaths.weaken, hack.securityLevelIncrease);
  const grow = calculateGrow(ns, host, scriptPaths.grow);
  const secondWeaken = calculateWeaken(ns, host, scriptPaths.weaken, grow.securityLevelIncrease);

  const steps = [ hack, firstWeaken, grow, secondWeaken];

  return {
    type: 'exploit',
    steps,
    totalDuration: calculateStepsDuration(steps),
    totalRamNeeded: calculateStepsRamNeeded(steps),
  };
}
